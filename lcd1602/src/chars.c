#include "chars.h"

// Размеры символа
#define CHAR_WIDTH 5
#define CHAR_HEIGHT 8

// Таблица символов HD44780 (ROM Code A00)
// Каждый символ представлен 8 байтами (только нижние 5 бит используются)
static const uint8_t hd44780_charset[256][8] = {
    // 0x00-0x0F: Японские символы и специальные
    [0x00] = {0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00}, // (null)
    [0x01] = {0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00}, // 
    // ... остальные японские символы
    
    // 0x10-0x1F: Специальные символы
    [0x10] = {0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00},
    
    // 0x20-0x7F: Стандартные ASCII символы
    [0x20] = {0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00}, // Space
    [0x21] = {0x00, 0x04, 0x04, 0x04, 0x04, 0x00, 0x04, 0x00}, // !
    [0x22] = {0x00, 0x0A, 0x0A, 0x0A, 0x00, 0x00, 0x00, 0x00}, // "
    [0x23] = {0x00, 0x0A, 0x1F, 0x0A, 0x0A, 0x1F, 0x0A, 0x00}, // #
    [0x24] = {0x00, 0x04, 0x0F, 0x14, 0x0E, 0x05, 0x1E, 0x04}, // $
    [0x25] = {0x00, 0x18, 0x19, 0x02, 0x04, 0x08, 0x13, 0x03}, // %
    [0x26] = {0x00, 0x0C, 0x12, 0x14, 0x08, 0x15, 0x12, 0x0D}, // &
    [0x27] = {0x00, 0x0C, 0x04, 0x08, 0x00, 0x00, 0x00, 0x00}, // '
    [0x28] = {0x00, 0x02, 0x04, 0x08, 0x08, 0x08, 0x04, 0x02}, // (
    [0x29] = {0x00, 0x08, 0x04, 0x02, 0x02, 0x02, 0x04, 0x08}, // )
    [0x2A] = {0x00, 0x00, 0x04, 0x15, 0x0E, 0x15, 0x04, 0x00}, // *
    [0x2B] = {0x00, 0x00, 0x04, 0x04, 0x1F, 0x04, 0x04, 0x00}, // +
    [0x2C] = {0x00, 0x00, 0x00, 0x00, 0x00, 0x0C, 0x04, 0x08}, // ,
    [0x2D] = {0x00, 0x00, 0x00, 0x00, 0x1F, 0x00, 0x00, 0x00}, // -
    [0x2E] = {0x00, 0x00, 0x00, 0x00, 0x00, 0x0C, 0x0C, 0x00}, // .
    [0x2F] = {0x00, 0x00, 0x01, 0x02, 0x04, 0x08, 0x10, 0x00}, // /
    
    // Цифры 0-9
    [0x30] = {0x00, 0x0E, 0x11, 0x13, 0x15, 0x19, 0x11, 0x0E}, // 0
    [0x31] = {0x00, 0x04, 0x0C, 0x04, 0x04, 0x04, 0x04, 0x0E}, // 1
    [0x32] = {0x00, 0x0E, 0x11, 0x01, 0x02, 0x04, 0x08, 0x1F}, // 2
    [0x33] = {0x00, 0x1F, 0x02, 0x04, 0x02, 0x01, 0x11, 0x0E}, // 3
    [0x34] = {0x00, 0x02, 0x06, 0x0A, 0x12, 0x1F, 0x02, 0x02}, // 4
    [0x35] = {0x00, 0x1F, 0x10, 0x1E, 0x01, 0x01, 0x11, 0x0E}, // 5
    [0x36] = {0x00, 0x06, 0x08, 0x10, 0x1E, 0x11, 0x11, 0x0E}, // 6
    [0x37] = {0x00, 0x1F, 0x01, 0x02, 0x04, 0x08, 0x08, 0x08}, // 7
    [0x38] = {0x00, 0x0E, 0x11, 0x11, 0x0E, 0x11, 0x11, 0x0E}, // 8
    [0x39] = {0x00, 0x0E, 0x11, 0x11, 0x0F, 0x01, 0x02, 0x0C}, // 9
    
    // Символы пунктуации
    [0x3A] = {0x00, 0x00, 0x0C, 0x0C, 0x00, 0x0C, 0x0C, 0x00}, // :
    [0x3B] = {0x00, 0x00, 0x0C, 0x0C, 0x00, 0x0C, 0x04, 0x08}, // ;
    [0x3C] = {0x00, 0x02, 0x04, 0x08, 0x10, 0x08, 0x04, 0x02}, // <
    [0x3D] = {0x00, 0x00, 0x00, 0x1F, 0x00, 0x1F, 0x00, 0x00}, // =
    [0x3E] = {0x00, 0x08, 0x04, 0x02, 0x01, 0x02, 0x04, 0x08}, // >
    [0x3F] = {0x00, 0x0E, 0x11, 0x01, 0x02, 0x04, 0x00, 0x04}, // ?
    [0x40] = {0x00, 0x0E, 0x11, 0x17, 0x15, 0x17, 0x10, 0x0E}, // @
    
    // Заглавные буквы A-Z
    [0x41] = {0x00, 0x04, 0x0A, 0x11, 0x11, 0x1F, 0x11, 0x11}, // A
    [0x42] = {0x00, 0x1E, 0x11, 0x11, 0x1E, 0x11, 0x11, 0x1E}, // B
    [0x43] = {0x00, 0x0E, 0x11, 0x10, 0x10, 0x10, 0x11, 0x0E}, // C
    [0x44] = {0x00, 0x1E, 0x11, 0x11, 0x11, 0x11, 0x11, 0x1E}, // D
    [0x45] = {0x00, 0x1F, 0x10, 0x10, 0x1E, 0x10, 0x10, 0x1F}, // E
    [0x46] = {0x00, 0x1F, 0x10, 0x10, 0x1E, 0x10, 0x10, 0x10}, // F
    [0x47] = {0x00, 0x0E, 0x11, 0x10, 0x10, 0x13, 0x11, 0x0F}, // G
    [0x48] = {0x00, 0x11, 0x11, 0x11, 0x1F, 0x11, 0x11, 0x11}, // H
    [0x49] = {0x00, 0x0E, 0x04, 0x04, 0x04, 0x04, 0x04, 0x0E}, // I
    [0x4A] = {0x00, 0x07, 0x02, 0x02, 0x02, 0x02, 0x12, 0x0C}, // J
    [0x4B] = {0x00, 0x11, 0x12, 0x14, 0x18, 0x14, 0x12, 0x11}, // K
    [0x4C] = {0x00, 0x10, 0x10, 0x10, 0x10, 0x10, 0x10, 0x1F}, // L
    [0x4D] = {0x00, 0x11, 0x1B, 0x15, 0x15, 0x11, 0x11, 0x11}, // M
    [0x4E] = {0x00, 0x11, 0x11, 0x19, 0x15, 0x13, 0x11, 0x11}, // N
    [0x4F] = {0x00, 0x0E, 0x11, 0x11, 0x11, 0x11, 0x11, 0x0E}, // O
    
    [0x50] = {0x00, 0x1E, 0x11, 0x11, 0x1E, 0x10, 0x10, 0x10}, // P
    [0x51] = {0x00, 0x0E, 0x11, 0x11, 0x11, 0x15, 0x12, 0x0D}, // Q
    [0x52] = {0x00, 0x1E, 0x11, 0x11, 0x1E, 0x14, 0x12, 0x11}, // R
    [0x53] = {0x00, 0x0F, 0x10, 0x10, 0x0E, 0x01, 0x01, 0x1E}, // S
    [0x54] = {0x00, 0x1F, 0x04, 0x04, 0x04, 0x04, 0x04, 0x04}, // T
    [0x55] = {0x00, 0x11, 0x11, 0x11, 0x11, 0x11, 0x11, 0x0E}, // U
    [0x56] = {0x00, 0x11, 0x11, 0x11, 0x11, 0x11, 0x0A, 0x04}, // V
    [0x57] = {0x00, 0x11, 0x11, 0x11, 0x15, 0x15, 0x1B, 0x11}, // W
    [0x58] = {0x00, 0x11, 0x11, 0x0A, 0x04, 0x0A, 0x11, 0x11}, // X
    [0x59] = {0x00, 0x11, 0x11, 0x0A, 0x04, 0x04, 0x04, 0x04}, // Y
    [0x5A] = {0x00, 0x1F, 0x01, 0x02, 0x04, 0x08, 0x10, 0x1F}, // Z
    
    // Символы квадратных скобок и обратной косой черты
    [0x5B] = {0x00, 0x0E, 0x08, 0x08, 0x08, 0x08, 0x08, 0x0E}, // [
    [0x5C] = {0x00, 0x10, 0x08, 0x04, 0x02, 0x01, 0x00, 0x00}, // \
    [0x5D] = {0x00, 0x0E, 0x02, 0x02, 0x02, 0x02, 0x02, 0x0E}, // ]
    [0x5E] = {0x00, 0x04, 0x0A, 0x11, 0x00, 0x00, 0x00, 0x00}, // ^
    [0x5F] = {0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x1F}, // _
    
    // Строчные буквы a-z
    [0x61] = {0x00, 0x00, 0x00, 0x0E, 0x01, 0x0F, 0x11, 0x0F}, // a
    [0x62] = {0x00, 0x10, 0x10, 0x10, 0x1E, 0x11, 0x11, 0x1E}, // b
    [0x63] = {0x00, 0x00, 0x00, 0x0E, 0x11, 0x10, 0x11, 0x0E}, // c
    [0x64] = {0x00, 0x01, 0x01, 0x01, 0x0F, 0x11, 0x11, 0x0F}, // d
    [0x65] = {0x00, 0x00, 0x00, 0x0E, 0x11, 0x1F, 0x10, 0x0E}, // e
    [0x66] = {0x00, 0x06, 0x09, 0x08, 0x1C, 0x08, 0x08, 0x08}, // f
    [0x67] = {0x00, 0x00, 0x0F, 0x11, 0x11, 0x0F, 0x01, 0x0E}, // g
    [0x68] = {0x00, 0x10, 0x10, 0x10, 0x16, 0x19, 0x11, 0x11}, // h
    [0x69] = {0x00, 0x04, 0x00, 0x0C, 0x04, 0x04, 0x04, 0x0E}, // i
    [0x6A] = {0x00, 0x02, 0x00, 0x06, 0x02, 0x02, 0x12, 0x0C}, // j
    [0x6B] = {0x00, 0x10, 0x10, 0x12, 0x14, 0x18, 0x14, 0x12}, // k
    [0x6C] = {0x00, 0x0C, 0x04, 0x04, 0x04, 0x04, 0x04, 0x0E}, // l
    [0x6D] = {0x00, 0x00, 0x00, 0x1A, 0x15, 0x15, 0x15, 0x15}, // m
    [0x6E] = {0x00, 0x00, 0x00, 0x16, 0x19, 0x11, 0x11, 0x11}, // n
    [0x6F] = {0x00, 0x00, 0x00, 0x0E, 0x11, 0x11, 0x11, 0x0E}, // o
    
    // Продолжение строчных букв
    [0x70] = {0x00, 0x00, 0x1E, 0x11, 0x11, 0x1E, 0x10, 0x10}, // p
    [0x71] = {0x00, 0x00, 0x0F, 0x11, 0x11, 0x0F, 0x01, 0x01}, // q
    [0x72] = {0x00, 0x00, 0x00, 0x16, 0x19, 0x10, 0x10, 0x10}, // r
    [0x73] = {0x00, 0x00, 0x00, 0x0F, 0x10, 0x0E, 0x01, 0x1E}, // s
    [0x74] = {0x00, 0x08, 0x08, 0x1C, 0x08, 0x08, 0x09, 0x06}, // t
    [0x75] = {0x00, 0x00, 0x00, 0x11, 0x11, 0x11, 0x13, 0x0D}, // u
    [0x76] = {0x00, 0x00, 0x00, 0x11, 0x11, 0x11, 0x0A, 0x04}, // v
    [0x77] = {0x00, 0x00, 0x00, 0x11, 0x11, 0x15, 0x15, 0x0A}, // w
    [0x78] = {0x00, 0x00, 0x00, 0x11, 0x0A, 0x04, 0x0A, 0x11}, // x
    [0x79] = {0x00, 0x00, 0x00, 0x11, 0x11, 0x0F, 0x01, 0x0E}, // y
    [0x7A] = {0x00, 0x00, 0x00, 0x1F, 0x02, 0x04, 0x08, 0x1F}, // z
    
    // Символы фигурных скобок и тильды
    [0x7B] = {0x00, 0x02, 0x04, 0x04, 0x08, 0x04, 0x04, 0x02}, // {
    [0x7C] = {0x00, 0x04, 0x04, 0x04, 0x04, 0x04, 0x04, 0x04}, // |
    [0x7D] = {0x00, 0x08, 0x04, 0x04, 0x02, 0x04, 0x04, 0x08}, // }
    [0x7E] = {0x00, 0x00, 0x00, 0x08, 0x15, 0x02, 0x00, 0x00}, // ~
    
    // Специальные символы LCD (0xA0-0xFF)
    [0xDF] = {0x00, 0x0E, 0x11, 0x11, 0x17, 0x15, 0x17, 0x10}, // β
};

// Предопределенные пользовательские символы (CGRAM)
static const uint8_t custom_chars[8][8] = {
    // Символ 0: Сердечко
    {0x00, 0x00, 0x0A, 0x1F, 0x1F, 0x0E, 0x04, 0x00},
    // Символ 1: Стрелка вверх
    {0x00, 0x04, 0x0E, 0x1F, 0x04, 0x04, 0x04, 0x00},
    // Символ 2: Стрелка вниз
    {0x00, 0x04, 0x04, 0x04, 0x1F, 0x0E, 0x04, 0x00},
    // Символ 3: Стрелка влево
    {0x00, 0x04, 0x08, 0x1F, 0x08, 0x04, 0x00, 0x00},
    // Символ 4: Стрелка вправо
    {0x00, 0x04, 0x02, 0x1F, 0x02, 0x04, 0x00, 0x00},
    // Символ 5: Галочка
    {0x00, 0x00, 0x01, 0x02, 0x14, 0x08, 0x00, 0x00},
    // Символ 6: Крестик
    {0x00, 0x11, 0x0A, 0x04, 0x0A, 0x11, 0x00, 0x00},
    // Символ 7: Заполненный блок
    {0x1F, 0x1F, 0x1F, 0x1F, 0x1F, 0x1F, 0x1F, 0x1F}
};

// Функция для получения данных символа по коду
const uint8_t* get_char_data(uint8_t char_code) {
    // Пользовательские символы (0x00-0x07)
    if (char_code < 8) {
        return custom_chars[char_code];
    }
    
    // Стандартные символы HD44780
    if (char_code < 256) {
        return hd44780_charset[char_code];
    }
    
    // Возвращаем пробел для неверных кодов
    return hd44780_charset[0x20];
}